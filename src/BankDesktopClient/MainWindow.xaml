<Window x:Class="BankDesktopClient.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:BankDesktopClient" BorderBrush="Beige" 
        mc:Ignorable="d"
        Title="Azure Active Directory Authentication Samples" Height="700" Width="900" Background="#022B3A" FontFamily="Segoe UI Semilight" >
    <Window.Resources>
        <Style TargetType="{x:Type Label}">
            <Setter Property="Control.Foreground" Value="White"/>
        </Style>
    </Window.Resources>

    
    <StackPanel Orientation="Vertical" Margin="0,0,0,0">
        <Label FontFamily="Segoe UI Semibold" Content="Sample Desktop Client For AAD-protected APIs" HorizontalAlignment="Center"  VerticalAlignment="Center"/>
        <Label Content="This is a public client made to show how to consume APIs protected by AAD, both by Microsoft (MSGraph) and developed by you (BankInfo Sample API)."/>
        <Label>
            <TextBlock><Run Text="This app does "/><Span FontFamily="Segoe UI Semibold"><Run Text="not"/></Span><Run Text=" use MSAL / ADAL for authentication, so you can see what is going on under the hood."/></TextBlock>
        </Label>
        <Label Content="To be able to call APIs, it uses the OAUTH2 authorization code flow with PKCE support (which is the safest way)." Background="{x:Null}"/>
        <Label Content="We will get an authorization code for our BankINFO API and one for Microsoft Graph and we will use it to get an Access Token (to use the target API) and a refresh token." />
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="5 5 5 5">
            <Button Background="#1F7A8C" Foreground="White" x:Name="GetAuthCodeForBankInfo" Margin="5 5 5 5" Content="Get Authorization Code for Bank Info API" HorizontalAlignment="Left" Click="GetAuthCodeForBankInfoAPI_Click" Width="300"/>
            <Button Background="#E1E5F2" Foreground="Black" x:Name="GetAuthCodeForMSGraph" Margin="5" Content="Get Authorization Code for MS Graph" HorizontalAlignment="Left" Click="GetAuthCodeForBankInfoAPI_Click" Width="300"/>
            <Button Background="#BFDBF7" Foreground="Black" x:Name="LogMeOut" Margin="5" Content="Log Out" Click="LogMeOut_Click" Width="300"/>
        </StackPanel>
        <StackPanel Orientation="Horizontal" Margin="5 5 5 5">
            <WebBrowser Height="200" Width="400" x:Name="AuthBrowser" LoadCompleted ="AuthBrowser_Navigated" Margin="0 0 0 10"  />
            <StackPanel Orientation="Vertical">
                <StackPanel Orientation="Vertical" HorizontalAlignment="Left" >
                    <Label Margin="10 0 0 0" Content="Auth Code Response for BankInfo API:"  Width="400" HorizontalAlignment="Left"/>
                    <TextBox Margin="10 0 0 0" x:Name="AuthCodeBankInfo" VerticalAlignment="Center" Width="400" TextWrapping="NoWrap"  Text="..." />
                    <Button Margin="10 0 0 0" Background="#1F7A8C" Foreground="White" x:Name="CopyAuthCodeBankInfo"  Content="Copy" Click="CopyAuthBankInfo_Click" />
                </StackPanel>
                <StackPanel Orientation="Vertical" HorizontalAlignment="Left" >
                    <Label Margin="10 0 0 0" Content="Auth Code Response for MSGraph API:" Width="400" HorizontalAlignment="Left"/>
                    <TextBox Margin="10 0 0 0" x:Name="AuthCodeMSGraph" VerticalAlignment="Center" Width="400" TextWrapping="NoWrap"  Text="..." />
                    <Button x:Name="CopyAuthCodeMSGraph" Margin="10 0 0 0" Content="Copy" Click="CopyAuthCodeMSGraph_Click"/>
                </StackPanel>
            </StackPanel>
        </StackPanel>
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="5 5 5 5">
            <Button Background="#1F7A8C" Foreground="White" x:Name="GetTokensForBankInfo" Margin="5 5 5 5" Content="Get Access and Refresh Token for Bank Info API" HorizontalAlignment="Left" Click="GetTokensForBankInfoAPI_Click" Width="300"/>
            <Button Background="#E1E5F2" Foreground="Black" x:Name="GetTokensForMSGraph" Margin="5" Content="Get Access and Refresh Token for MS Graph" HorizontalAlignment="Left" Click="GetAuthCodeForBankInfoAPI_Click" Width="300"/>
        </StackPanel>
        <StackPanel Orientation="Vertical">
            <StackPanel Orientation="Horizontal">
                <StackPanel Orientation="Vertical" HorizontalAlignment="Left" >
                    <Label Margin="10 0 0 0" Content="Response from BankInfo API token endpoint:"  Width="250" HorizontalAlignment="Left"/>
                    <TextBox Margin="10 0 0 0" x:Name="BankInfoAPITokens" VerticalAlignment="Center" Width="250" TextWrapping="NoWrap"  Text="..." />
                    <Button Margin="10 0 0 0" x:Name="CopyBankInfoAccessToken"  Content="Copy to clipboard" Click="CopyBankAPITokenInfo_Click" />
                </StackPanel>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" >
                    <Button Background="#1F7A8C" Foreground="White" Margin="10 0 0 0" x:Name="ShowBankInfoAccessToken"  Click="CopyBankAPIAccessToken_Click" Width="120" >
                        <TextBlock TextAlignment="Center" Text="Copy Access Token" />
                    </Button>
                    <Button Background="#E1E5F2" Margin="10 0 0 0" x:Name="ShowBankInfoIDToken" Click="CopyBankAPIIDToken_Click" Width="120" >
                        <TextBlock TextAlignment="Center" Text="Copy ID Token" />
                    </Button>
                    <Button Background="#BFDBF7" Margin="10 0 0 0" x:Name="ShowBankInfoRefreshToken"  Click="CopyBankAPIRefreshToken_Click" Width="120">
                        <TextBlock TextAlignment="Center" Text="Copy Refresh Token" />
                    </Button>
                    <Button Background="#1F7A8C" Foreground="White" Margin="10 0 0 0" x:Name="RefreshBankInfoToken" Click="CopyAuthBankInfo_Click"  Width="120">
                        <TextBlock TextAlignment="Center" >Get new Tokens<LineBreak/>with Refresh Token</TextBlock>
                    </Button>

                </StackPanel>

            </StackPanel>
            <StackPanel Orientation="Horizontal">
                <StackPanel Orientation="Vertical" HorizontalAlignment="Left" >
                    <Label Margin="10 0 0 0" Content="Response from MS Graph token endpoint:" Width="250" HorizontalAlignment="Left"/>
                    <TextBox Margin="10 0 0 0" x:Name="MSGraphAccessToken" VerticalAlignment="Center" Width="250" TextWrapping="NoWrap"  Text="..." />
                    <Button x:Name="CopyMSGraphAccessToken" Margin="10 0 0 0" Content="Inspect with jwt.io" Click="CopyAuthCodeMSGraph_Click"/>
                </StackPanel>
                <StackPanel Orientation="Vertical" HorizontalAlignment="Left" >
                    <Label Margin="10 0 0 0" Content="Refresh Token for MSGraph API:"  Width="180" HorizontalAlignment="Left"/>
                </StackPanel>
                <StackPanel Orientation="Vertical" HorizontalAlignment="Left" >
                    <Label Margin="10 0 0 0" Width="180" HorizontalAlignment="Left" Content=" "/>
                    <Button Margin="10 0 0 0" x:Name="RefreshMSGraphToken"  Content="Get New Access Token with Refresh Token" Click="CopyAuthBankInfo_Click" />
                </StackPanel>
            </StackPanel>
        </StackPanel>
        <Label Content="Finally, let us call the back-end sample API to make sure it validates our token." Background="{x:Null}"/>
    </StackPanel>
</Window>
